---
title: "Computational_Stats_Project"
author: "Sophie Meichtry"
date: "4/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Import Data

```{r}
heartdata <- read.table("/Users/sophiameichtry/Downloads/heart_failure_clinical_records_dataset.csv", 
                        header = TRUE,
                        sep = ",")
```

# Clean Data

```{r}
head(heartdata)
dim(heartdata)
```

```{r}
sum(is.na(heartdata))
```

#Checking for NA values -- 0 in this data set.

```{r}
summary(heartdata)
```

#describing the data

# Visualizations

```{r}
library(ggplot2)
ggplot(heartdata, aes(x=age)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows...

```{r}
ggplot(heartdata, aes(x=anaemia)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows...

```{r}
ggplot(heartdata, aes(x=creatinine_phosphokinase)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that

```{r}
ggplot(heartdata, aes(x=diabetes)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows that

```{r}
ggplot(heartdata, aes(x=ejection_fraction)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=high_blood_pressure)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=platelets)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=serum_creatinine)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=serum_sodium)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=sex)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=smoking)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=time)) +   
  geom_histogram(color="white", fill="red")
```

#This plot shows that...

```{r}
ggplot(heartdata, aes(x=DEATH_EVENT)) +   
  geom_bar(color="white", fill="red")
```

#This plot shows that...

# Checking for Assumptions

```{r}

```

# Remedies for Violations of Assumptions

```{r}

```

# Logistic Regression

```{r}
set.seed(123)
n = nrow(heartdata)
split <- sample(1:n, 0.8*n, replace = FALSE)
training <- heartdata[split,]
test <- heartdata[-split,]
```

```{r}
library(bestglm)
bs1 <- bestglm(Xy = training, family = binomial, IC = "BIC")
summary(bs1)
bs1$BestModels
bs1$Subsets
```

# Model Selection

```{r}
model1 <- glm(DEATH_EVENT ~ ejection_fraction + serum_creatinine + time, family = binomial, 
              data = training)
summary(model1)
```

```{r}
bs2 <- bestglm(Xy = training, family = binomial, IC = "AIC")
summary(bs2)
bs2$BestModels
bs2$Subsets
```

```{r}
model2 <- glm(DEATH_EVENT ~ ejection_fraction + diabetes + age  + serum_creatinine + time, family = binomial, 
              data = training)
summary(model2)
```

```{r}
model3 <- glm(DEATH_EVENT ~ ., family = binomial, 
              data = training)
summary(model3)
```

# Accuracy Rate?

```{r}
predicted<-predict(model2, test, type="response")
for (i in 1:length(predicted)) {
  if(predicted[i]>=0.05){
    predicted[i]=1
  } else
  {predicted[i]=0
  }
}

(accuracy <- (length(which(predicted==test$DEATH_EVENT)) / 59.8) * 100)
```

# Cross Validation

```{r}

```

# CART

```{r}

```

# Model Comparison

```{r}

```

# LDA

```{r}

```

